# GreekLUG InfoBox

Στο αποθετήριο περιέχεται ο κώδικας και πληροφορίες για το InfoBox Project του GreekLUG.

Το InfoBox λειτουργεί ως μία οθόνη πληροφοριών για τους επισκέπτες του GNU/Linux Lab Θεσσαλονίκης, εμφανίζοντας χρήσιμες πληροφορίες οι οποίες ανακτώνται από ένα url/ιστοσελίδα.

## Υλικά - Στοιχεία

Η υλοποίηση του Infobox στηρίζεται σε:
* έναν μικροϋπολογιστή Raspberry Pi, 
* μία οθόνη με υποδοχή HDMΙ,
* τοπικό (ασύρματο) δίκτυο με στατική IP και 
* μία web πλατφόρμα στηριγμένη στο PHP Framework Laravel και την βάση δεδομένων MariaDB.


## Raspberry Pi - Λειτουργία Kiosk

Για την καρδιά του InfoBox επιλέχθηκε ο μικροϋπολογιστής **Raspberry Pi** και ειδικότερα το μοντέλο Raspberry Pi 3 Model B, καθώς προσφέρει την δυνατότητα ασύρματης σύνδεσης δικτύου μέσω WiFi.

Ως λειτουργικό σύστημα εγκαταστάθηκε το **Raspbian**, το οποίο είναι το επίσημο υποστηριζόμενο λειτουργικό σύστημα του Raspberry Pi Foundation και στηρίζεται στην διανομή GNU/Linux Debian.

Στα πλαίσια λειτουργίας του Raspberry Pi χρειάζεται να υπάρχουν τα τυπικά προαπαιτούμενα στοιχεία, όπως:
* μία κάρτα SD ελάχιστου μεγέθους 8GB για την εγκατάσταση του συστήματος,
* τροφοδοτικό για το Raspberry Pi, και
* ένα καλώδιο HDMI μικρού μήκους

Για τα πρώτα βήματα της εγκατάστασης και ρύθμισης χρειάζεται επίσης ένα πληκτρολόγιο και ένα ποντίκι με σύνδεση usb.
Μετά την ρύθμιση αυτά μπορούν να αφαιρεθούν καθώς το InfoBox θα εμφανίζει αυτόματα το επιθυμητό web περιεχόμενό.

### Εγκατάσταση Raspbian

Ξεκινάμε με την εγκατάσταση του Rasbian στην κάρτα SD μας. Ως αρχικό βήμα κατεβάζουμε την εικόνα του λειτουργικού συστήματος από το url https://www.raspberrypi.org/downloads/raspbian/ και συγκεκριμένα την πλήρη έκδοση που αναφέρεται ως "RASPBIAN STRETCH WITH DESKTOP Image with desktop based on Debian Stretch".

Καθώς το αρχείο λήψης είναι σε συμπιεσμένη μορφή **.zip** (πχ *2018-04-18-raspbian-stretch.zip*) θα πρέπει να το αποσυμπιέσουμε ώστε να εξάγουμε το αρχείο της εικόνας σε μορφή **.img** (πχ *2018-04-18-raspbian-stretch.img*). 

Στην συνέχεια γράφουμε την εικόνα δίσκου στην κάρτα SD. Αυτό μπορεί να γίνει, είτε με κάποια εφαρμογή όπως την [Etcher](https://etcher.io/) ή την [GNOME Disks](https://wiki.gnome.org/Apps/Disks), είτε μέσω τερματικού εφόσον είμαστε εξοικειωμένοι με αυτό και την εντολή dd, πχ `dd bs=4M if=2018-04-18-raspbian-stretch.img of=/dev/sdc conv=fsync`.

Τέλος, τοποθετούμε την κάρτα SD και το ανοίγουμε, έχοντας συνδέσει το πληκτρολόγιο, το ποντίκι και την οθόνη μας με αυτό και προετοιμάσει κάποια σύνδεση δικτύου.

### Ρύθμιση Raspbian

Μετά την αρχική εκκίνηση, η οποία μπορεί να χρειαστεί μερικά λεπτά για να ολοκληρωθεί, προχωράμε με την ρύθμιση του Rasbian με βάση τον οδηγό ρύθμισης που εμφανίζεται κατά την πρώτη μας εκκίνηση. Σε αυτό μπορούμε να ορίσουμε τον κωδικό πρόσβασης για τον χρήστη pi αλλά και να ρυθμίσουμε το τοπικό (ασύρματο) δίκτυο με κάποια **στατική IP**, πχ 192.168.1.50.

Στην συνέχεια ολοκληρώνεται ο οδηγός ρύθμισης με επανεκκίνηση και προχωράμε στο να ορίσουμε κάποιες βασικές λειτουργίες ώστε το Raspberry Pi να λειτουργεί με την μορφή Kiosk.

Συγκεκριμένα θα πρέπει να ορίσουμε το Raspberry Pi ώστε:
* να ανοίγει σε γραφικό περιβάλλον αυτόματα εφόσον υπάρχει δίκτυο, 
* να φορτώνει τον περιηγητή Chromium αυτόματα σε κατάσταση kiosk,
* να μην εμφανίζεται η προφύλαξη οθόνης, και
* να έχει ενεργές υπηρεσίες SSH και VNC για απομακρυσμένη διαχείριση.

Για να κάνουμε τα παραπάνω μεταβαίνουμε αρχικά στο Μενού και πλοηγούμαστε στις Προτιμήσεις --> Raspberry Pi Configuration.
Στο παράθυρο ρυθμίσεων επιλέγουμε την καρτέλα **System**, όπου ορίζουμε τα παρακάτω: 
* Boot: Επιλέγουμε το "to Dekstop"
* Auto login: Τσεκάρουμε το "Login as user 'pi'"
* Network at Boot: Επιλέγουμε το "Wait for network"

Έπειτα επιλέγουμε την καρτέλα **Interfaces**, όπου ορίζουμε τα παρακάτω: 
* SSH: Επιλέγουμε το "Enable"
* VNC: Επιλέγουμε το "Enable"

Το παραπάνω είναι απαραίτητο εφόσον το Raspberry Pi θα τοποθετηθεί σε θέση InfoBox και θα έχουμε αφαιρέσει το πληκτρολόγιο/ποντίκι από αυτό.

Στην συνέχεια ανοίγουμε το τερματικό και εγκαθιστούμε την εφαρμογή διαχείρισης **xscreensaver**:

`sudo apt-get install xscreensaver`

Μετά από αυτό μεταβαίνουμε στο Μενού, βρίσκουμε την εφαρμογή και απενεργοποιούμε το σβήσιμο της οθόνης.

Έπειτα επεξεργαζόμαστε το αρχείο αυτόματης εκκίνησης **autostart** προσθέτοντας στο τέλος του αρχείου μία γραμμή για την εκκίνηση του περιηγητή Chromium σε κατάσταση kiosk με φόρτωση του επιθυμητού url.
Το αρχείο βρίσκεται στην διαδρομή */home/pi/.config/lxsession/LXDE-pi/*, το οποίο μπορούμε να επεξεργαστούμε μέσω τερματικού με την εντολή:

`sudo nano /home/pi/.config/lxsession/LXDE-pi/autostart`

Μόλις ανοίξει, προσθέτουμε ως τελευταία γραμμή την παρακάτω εντολή:

`@chromium-browser --incognito --kiosk https://www.infobox.com`
